<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Signup</title>
  <link rel="stylesheet" href="style1.css">
  <link href="css/style.css" rel="stylesheet">
  <!-- <script type="text/javascript" src="validation.js" defer></script> -->
 <!-- <script type="module" src="fire.js"></script> -->
</head>
<body>
  
    <!-- Navbar Start -->
    <div class="container-fluid">
      <div class="row border-top px-xl-5">
          <div class="col-lg-3 d-none d-lg-block">
              <a class="d-flex align-items-center justify-content-between bg-secondary w-100 text-decoration-none"
                  data-toggle="collapse" href="#navbar-vertical" style="height: 67px; padding: 0 30px;">
                  <!-- <h5 class="text-primary m-0"><i class="fa fa-book-open mr-2"></i>Subjects</h5>
                  <i class="fa fa-angle-down text-primary"></i> -->
                  <img src="img/Edu-tech-logo.jpeg" class="w-100">
              </a>
              <nav class="collapse position-absolute navbar navbar-vertical navbar-light align-items-start p-0 border border-top-0 border-bottom-0 bg-light"
                  id="navbar-vertical" style="width: calc(100% - 30px); z-index: 9;">
                  <div class="navbar-nav w-100">
                      <div class="nav-item dropdown">
                          <a href="#" class="nav-link" data-toggle="dropdown">Web Design <i
                                  class="fa fa-angle-down float-right mt-1"></i></a>
                          <div class="dropdown-menu position-absolute bg-secondary border-0 rounded-0 w-100 m-0">
                              <a href="" class="dropdown-item">HTML</a>
                              <a href="" class="dropdown-item">CSS</a>
                              <a href="" class="dropdown-item">jQuery</a>
                          </div>
                      </div>
                      <a href="" class="nav-item nav-link">Apps Design</a>
                      <a href="" class="nav-item nav-link">Marketing</a>
                      <a href="" class="nav-item nav-link">Research</a>
                      <a href="" class="nav-item nav-link">SEO</a>
                  </div>
              </nav>
          </div>
          <div class="col-lg-9">
              <nav class="navbar navbar-expand-lg bg-light navbar-light py-3 py-lg-0 px-0">
                  <a href="" class="text-decoration-none d-block d-lg-none">
                      <h1 class="m-0"><span class="text-primary">E</span>COURSES</h1>
                  </a>
                  <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                      <span class="navbar-toggler-icon"></span>
                  </button>
                  <div class="collapse navbar-collapse justify-content-end" id="navbarCollapse">
                      <div class="navbar-nav py-0">
                          <a href="index.html" class="nav-item nav-link active">Home</a>
                          <a href="about.html" class="nav-item nav-link">About</a>
                          <a href="course.html" class="nav-item nav-link">Achievements</a>
                          <!-- <a href="teacher.html" class="nav-item nav-link">Teachers</a> -->
                          <!-- <div class="nav-item dropdown">
                              <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Blog</a>
                              <div class="dropdown-menu rounded-0 m-0">
                                  <a href="blog.html" class="dropdown-item">Blog List</a>
                                  <a href="single.html" class="dropdown-item">Blog Detail</a>
                              </div>
                          </div> -->
                          <a href="contact.html" class="nav-item nav-link">Contact</a>
                          <a class="nav-item nav-link btn btn-primary py-2 px-4 ml-auto login-btn"
                              href="login.html">Login</a>
                              <a class="nav-item nav-link btn btn-primary py-2 px-4 ml-auto login-btn"
                                href="signup.html">Sign Up</a>
                      </div>
                  </div>
              </nav>
          </div>
      </div>
  </div>
  <!-- Navbar End -->

  <div class="wrapper">
    <h1>Signup</h1>
    <p id="error-message"></p>
    <form id="userForm">
      <div>
        <label for="firstname-input">
          <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Z"/></svg>
        </label>
        <input type="text"  id="full_name" placeholder="Firstname">
      </div>
      <div>
        <!-- <label for="email-input">
          <span>@</span>
        </label> -->
        <input type="email"  id="email" placeholder="Email">
      </div>
      <div>
        <!-- <label for="password-input">
          <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M240-80q-33 0-56.5-23.5T160-160v-400q0-33 23.5-56.5T240-640h40v-80q0-83 58.5-141.5T480-920q83 0 141.5 58.5T680-720v80h40q33 0 56.5 23.5T800-560v400q0 33-23.5 56.5T720-80H240Zm240-200q33 0 56.5-23.5T560-360q0-33-23.5-56.5T480-440q-33 0-56.5 23.5T400-360q0 33 23.5 56.5T480-280ZM360-640h240v-80q0-50-35-85t-85-35q-50 0-85 35t-35 85v80Z"/></svg>
        </label> -->
        <input type="password" id="password" placeholder="Password">
      </div>
      <div>
        <!-- <label for="repeat-password-input">
          <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M240-80q-33 0-56.5-23.5T160-160v-400q0-33 23.5-56.5T240-640h40v-80q0-83 58.5-141.5T480-920q83 0 141.5 58.5T680-720v80h40q33 0 56.5 23.5T800-560v400q0 33-23.5 56.5T720-80H240Zm240-200q33 0 56.5-23.5T560-360q0-33-23.5-56.5T480-440q-33 0-56.5 23.5T400-360q0 33 23.5 56.5T480-280ZM360-640h240v-80q0-50-35-85t-85-35q-50 0-85 35t-35 85v80Z"/></svg>
        </label> -->
        <input type="text"  id="favourite_song" placeholder="favourite_song">
      </div>
      <div>
        <!-- <label for="repeat-password-input">
          <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M240-80q-33 0-56.5-23.5T160-160v-400q0-33 23.5-56.5T240-640h40v-80q0-83 58.5-141.5T480-920q83 0 141.5 58.5T680-720v80h40q33 0 56.5 23.5T800-560v400q0 33-23.5 56.5T720-80H240Zm240-200q33 0 56.5-23.5T560-360q0-33-23.5-56.5T480-440q-33 0-56.5 23.5T400-360q0 33 23.5 56.5T480-280ZM360-640h240v-80q0-50-35-85t-85-35q-50 0-85 35t-35 85v80Z"/></svg>
        </label> -->
        <input type="text"  id="milk_before_cereal" placeholder="milk_before_cereal">
      </div>
    <!-- <a href="index.html">  <button type="submit"  onclick="login()">Signup</button></a>
    </form>
    <p>Already have an Account? <a href="login.html" >login</a> </p> -->
    <button onclic="login()">Login</button>
    <button onClick="register()">Register</button>
   </form>
  </div>
  <!-- <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js"></script> -->
  
<!-- <script src="index.js"></script> -->


</body>
<!-- Load Firebase SDKs as modules -->
<script type="module">
  // Import Firebase modules
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";
  import { getDatabase, ref, set, update } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js";

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyCN6m0tDyKjGHZZ6jydq8BJ_NRtGqQW5m0",
    authDomain: "edu-sraddha.firebaseapp.com",
    databaseURL: "https://edu-sraddha-default-rtdb.firebaseio.com",
    projectId: "edu-sraddha",
    storageBucket: "edu-sraddha.appspot.com",
    messagingSenderId: "724188304454",
    appId: "1:724188304454:web:e0a1c43c8c929921a8a647"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const database = getDatabase(app);

  // Register function
  function register() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    const full_name = document.getElementById('full_name').value;
    const favourite_song = document.getElementById('favourite_song').value;
    const milk_before_cereal = document.getElementById('milk_before_cereal').value;

    // Validate input fields
    if (!validate_email(email) || !validate_password(password)) {
      alert('Email or Password is incorrect!');
      return;
    }
    if (!validate_field(full_name) || !validate_field(favourite_song) || !validate_field(milk_before_cereal)) {
      alert('One or more fields are empty!');
      return;
    }

    // Register the user
    createUserWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        const user = userCredential.user;
        const database_ref = ref(database, 'users/' + user.uid);

        // Create user data
        const user_data = {
          email: email,
          full_name: full_name,
          favourite_song: favourite_song,
          milk_before_cereal: milk_before_cereal,
          last_login: Date.now()
        };

        // Push to Firebase Database
        set(database_ref, user_data)
          .then(() => alert('User Created!'))
          .catch(error => alert("Error writing data to database: " + error.message));
      })
      .catch((error) => {
        alert(error.message);
      });
  }

  // Login function
  function login() {
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;

    // Validate input fields
    if (!validate_email(email) || !validate_password(password)) {
      alert('Email or Password is incorrect!');
      return;
    }

    signInWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
        const user = userCredential.user;
        const database_ref = ref(database, 'users/' + user.uid);

        // Update last login
        const user_data = {
          last_login: Date.now()
        };

        // Update Firebase Database
        update(database_ref, user_data)
          .then(() => alert('User Logged In!'))
          .catch(error => alert("Error updating data: " + error.message));
      })
      .catch((error) => {
        alert(error.message);
      });
  }

  // Validation functions
  function validate_email(email) {
    const expression = /^[^@]+@\w+(\.\w+)+\w$/;
    return expression.test(email);
  }

  function validate_password(password) {
    return password.length >= 6;
  }

  function validate_field(field) {
    return field != null && field.trim().length > 0;
  }
</script>
</html>